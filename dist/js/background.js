!function(){function a(a){c=a,chrome.tabs.get(a,function(a){d=a.url,e=a.title,b(c,d)})}function b(a,b){return-1!==b.indexOf("chrome://")||-1!==b.indexOf("chrome-extension://")?(chrome.browserAction.setBadgeText({text:"",tabId:a}),void 0):(f!==b&&(f=b,chrome.storage.sync.get([g.APIToken,g.isAuthenticated],function(c){var d=c[g.APIToken],e=c[g.isAuthenticated];if(e){var f=[];f.push("format=json"),f.push("auth_token="+d),f.push("url="+b);var h="https://api.pinboard.in/v1/posts/get?"+f.join("&");chrome.browserAction.setBadgeBackgroundColor({color:"#66cc33"}),$.getJSON(h).done(function(b){var c=0!==b.posts.length;chrome.browserAction.setBadgeText({text:c?"âœ“":"",tabId:a})}).fail(function(){chrome.browserAction.setBadgeText({text:"",tabId:a})})}})),void 0)}var c=0,d="",e="",f="",g={APIToken:"pinput_APIToken",isAuthenticated:"pinput_isAuthenticated"};chrome.tabs.onActivated.addListener(function(b){a(b.tabId)}),chrome.tabs.onUpdated.addListener(function(b){c===b&&a(b)}),chrome.windows.onFocusChanged.addListener(function(){chrome.windows.getCurrent({populate:!0},function(b){b.tabs.forEach(function(b){b.active&&a(b.id)})})}),chrome.runtime.onMessage.addListener(function(a,b,c){c({url:d,title:e})})}();